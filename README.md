# üõ°Ô∏è –°–∏—Å—Ç–µ–º–∞ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∫–æ–Ω—Ç—Ä–∞—Ñ–∞–∫—Ç–∞ –Ω–∞ –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–µ OZON

<div align="center">

![Python](https://img.shields.io/badge/python-v3.8+-blue.svg)
![PyTorch](https://img.shields.io/badge/PyTorch-%23EE4C2C.svg?style=flat&logo=PyTorch&logoColor=white)
![FastAPI](https://img.shields.io/badge/FastAPI-005571?style=flat&logo=fastapi)
![License](https://img.shields.io/badge/license-Internal-green.svg)

*–ö–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ ML-—Ä–µ—à–µ–Ω–∏–µ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –≤—ã—è–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ç—Ä–∞—Ñ–∞–∫—Ç–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤*

</div>

## üìã –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

–ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –¥–ª—è –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã OZON, –∏—Å–ø–æ–ª—å–∑—É—é—â–∞—è –∞–Ω—Å–∞–º–±–ª–µ–≤—ã–π –ø–æ–¥—Ö–æ–¥ —Å –≥–ª—É–±–æ–∫–∏–º –∞–Ω–∞–ª–∏–∑–æ–º:
- üî§ **–¢–µ–∫—Å—Ç–æ–≤—ã—Ö –æ–ø–∏—Å–∞–Ω–∏–π** —Ç–æ–≤–∞—Ä–æ–≤
- üìä **–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö** –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø—Ä–æ–¥–∞–∂  
- üë§ **–ü–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤** –ø—Ä–æ–¥–∞–≤—Ü–æ–≤

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–µ—à–µ–Ω–∏—è

<details>
<summary><strong>1Ô∏è‚É£ –ú–æ–¥—É–ª—å –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤</strong> <code>extract_emb.py</code></summary>

- üåê –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä–∞ **XLM-RoBERTa** –¥–ª—è –º—É–ª—å—Ç–∏—è–∑—ã—á–Ω—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤
- üéØ Fine-tuning –º–æ–¥–µ–ª–∏ –Ω–∞ –∑–∞–¥–∞—á–µ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∫–æ–Ω—Ç—Ä–∞—Ñ–∞–∫—Ç–∞
- üß† –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π –æ–ø–∏—Å–∞–Ω–∏–π –∏ –Ω–∞–∑–≤–∞–Ω–∏–π —Ç–æ–≤–∞—Ä–æ–≤

</details>

<details>
<summary><strong>2Ô∏è‚É£ –ú–æ–¥—É–ª—å –æ–±—Ä–∞–±–æ—Ç–∫–∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö</strong> <code>feature_eng.py</code></summary>

- ‚öôÔ∏è –°–æ–∑–¥–∞–Ω–∏–µ **40+** –∏–Ω–∂–µ–Ω–µ—Ä–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∏–∑ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø—Ä–æ–¥–∞–∂
- üìà CatBoost encoding –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
- üîç –ê–Ω–∞–ª–∏–∑ –ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –ø—Ä–æ–¥–∞–≤—Ü–æ–≤

</details>

<details>
<summary><strong>3Ô∏è‚É£ –ú–æ–¥—É–ª—å —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</strong> <code>extract_text_feature.py</code></summary>

- üö® –î–µ—Ç–µ–∫—Ü–∏—è –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤
- üåç –ê–Ω–∞–ª–∏–∑ —è–∑—ã–∫–æ–≤—ã—Ö –ø—Ä–æ–ø–æ—Ä—Ü–∏–π –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ç–µ–∫—Å—Ç–∞
- üìä –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫

</details>

<details>
<summary><strong>4Ô∏è‚É£ –ê–Ω—Å–∞–º–±–ª–µ–≤–∞—è –º–æ–¥–µ–ª—å</strong> <code>pred.py</code></summary>

- üé∞ **5 CatBoost –º–æ–¥–µ–ª–µ–π** —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ random seeds
- ‚öñÔ∏è –í–∑–≤–µ—à–µ–Ω–Ω–æ–µ —É—Å—Ä–µ–¥–Ω–µ–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π
- üéØ –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ—Ä–æ–≥ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏: **0.617**

</details>

<details>
<summary><strong>5Ô∏è‚É£ Web-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å</strong> <code>web.py</code></summary>

- üöÄ **FastAPI** —Å–µ—Ä–≤–∏—Å –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö
- ü§ñ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

</details>

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Å–∏—Å—Ç–µ–º–µ

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ |
|-----------|------------|
| üêç Python | 3.8+ |
| üéÆ GPU | CUDA-—Å–æ–≤–º–µ—Å—Ç–∏–º–∞—è (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è) |
| üíæ RAM | –ú–∏–Ω–∏–º—É–º 8GB |

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
# –û—Å–Ω–æ–≤–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
pip install pandas numpy scikit-learn
pip install catboost lightgbm xgboost

# NLP –∏ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä—ã
pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu118
pip install transformers
pip install nltk beautifulsoup4
pip install pymorphy3 pymorphy3-dicts-ru

# –î–ª—è –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è
pip install category_encoders

# Web-—Å–µ—Ä–≤–∏—Å
pip install fastapi uvicorn python-multipart
```

---

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
project/
‚îú‚îÄ‚îÄ ü§ñ models/                 # –ü—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏
‚îÇ   ‚îú‚îÄ‚îÄ model1.pkl            # CatBoost –º–æ–¥–µ–ª—å (seed=42)
‚îÇ   ‚îú‚îÄ‚îÄ model2.pkl            # CatBoost –º–æ–¥–µ–ª—å (seed=123)
‚îÇ   ‚îú‚îÄ‚îÄ model3.pkl            # CatBoost –º–æ–¥–µ–ª—å (seed=456)
‚îÇ   ‚îú‚îÄ‚îÄ model4.pkl            # CatBoost –º–æ–¥–µ–ª—å (seed=789)
‚îÇ   ‚îú‚îÄ‚îÄ model5.pkl            # CatBoost –º–æ–¥–µ–ª—å (seed=2024)
‚îÇ   ‚îú‚îÄ‚îÄ catboost_encoder.pkl  # –≠–Ω–∫–æ–¥–µ—Ä –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ PCA.pkl               # –†–µ–¥—å—é—Å–µ—Ä —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ –¥–ª—è —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤
‚îÇ
‚îú‚îÄ‚îÄ üìö resources/              # Fine-tuned —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä
‚îÇ   ‚îú‚îÄ‚îÄ tokenizer/            # –¢–æ–∫–µ–Ω–∏–∑–∞—Ç–æ—Ä
‚îÇ   ‚îú‚îÄ‚îÄ encoder/              # –≠–Ω–∫–æ–¥–µ—Ä –º–æ–¥–µ–ª–∏
‚îÇ   ‚îú‚îÄ‚îÄ classifier/           # –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–æ–Ω–Ω–∞—è –≥–æ–ª–æ–≤–∞
‚îÇ   ‚îú‚îÄ‚îÄ preprocessor.pkl      # –ü—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä —Ç–µ–∫—Å—Ç–∞
‚îÇ   ‚îî‚îÄ‚îÄ metadata.pkl
‚îÇ
‚îú‚îÄ‚îÄ üì§ output/                 # –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π
‚îú‚îÄ‚îÄ üìÅ workdir/in/             # –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
‚îÇ
‚îú‚îÄ‚îÄ üéØ main.py                 # –û—Å–Ω–æ–≤–Ω–æ–π –ø–∞–π–ø–ª–∞–π–Ω
‚îú‚îÄ‚îÄ üß† extract_emb.py          # –†–∞–±–æ—Ç–∞ —Å —ç–º–±–µ–¥–¥–∏–Ω–≥–∞–º–∏
‚îú‚îÄ‚îÄ ‚öôÔ∏è feature_eng.py          # –ò–Ω–∂–µ–Ω–µ—Ä–∏—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
‚îú‚îÄ‚îÄ üìù extract_text_feature.py # –¢–µ–∫—Å—Ç–æ–≤—ã–µ —Ñ–∏—á–∏
‚îú‚îÄ‚îÄ üé™ pred.py                 # –ê–Ω—Å–∞–º–±–ª–µ–≤—ã–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
‚îî‚îÄ‚îÄ üåê web.py                  # Web-—Å–µ—Ä–≤–∏—Å (FastAPI)
```

---

## üíª –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### üåê –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Web-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

```bash
# –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞
uvicorn web:app --reload --host 0.0.0.0 --port 8000

# –û—Ç–∫—Ä—ã—Ç—å –≤ –±—Ä–∞—É–∑–µ—Ä–µ http://localhost:8000
# –ó–∞–≥—Ä—É–∑–∏—Ç—å CSV —Ñ–∞–π–ª —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
# –°–∫–∞—á–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç
```

### üíª –ó–∞–ø—É—Å–∫ –∏–∑ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏

```python
from main import final

# –ü—É—Ç—å –∫ —Ç–µ—Å—Ç–æ–≤–æ–º—É —Ñ–∞–π–ª—É
test_file = "ml_ozon_counterfeit_test.csv"

# –ó–∞–ø—É—Å–∫ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π
output_path = final(test_file)
print(f"–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤: {output_path}")
```

### üéì –û–±—É—á–µ–Ω–∏–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏

```python
import extract_emb as ee

# –û–±—É—á–µ–Ω–∏–µ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤
ee.train_and_save_model(
    df_train=train_data,
    save_dir="./my_model",
    fine_tune_epochs=3,
    fine_tune_lr=5e-5,
    fine_tune_sample_size=10000
)

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏
embeddings = ee.inference_embeddings(
    df_test=test_data,
    model_dir="./my_model"
)
```

---

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### ‚öñÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ—Ä–æ–≥–∞ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏

```python
# –í —Ñ–∞–π–ª–µ main.py
submission = pd.DataFrame({
    'id': df_test['id'],
    'prediction': preds > 0.4  # <- –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ—Ä–æ–≥–∞
})
```

### üé™ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–Ω—Å–∞–º–±–ª—è

```python
# –í —Ñ–∞–π–ª–µ pred.py
weights = {
    'catboost_seed_42': 0.2,
    'catboost_seed_123': 0.2,
    'catboost_seed_456': 0.2,
    'catboost_seed_789': 0.2,
    'catboost_seed_2024': 0.2
}
```

---

## üîç –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ—à–µ–Ω–∏—è

<table>
<tr>
<td align="center">üéØ</td>
<td><strong>–ú—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥</strong><br>–ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö, —á–∏—Å–ª–æ–≤—ã—Ö –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</td>
</tr>
<tr>
<td align="center">üéì</td>
<td><strong>Fine-tuning –Ω–∞ —Ü–µ–ª–µ–≤–æ–π –∑–∞–¥–∞—á–µ</strong><br>–ê–¥–∞–ø—Ç–∞—Ü–∏—è —è–∑—ã–∫–æ–≤–æ–π –º–æ–¥–µ–ª–∏ –ø–æ–¥ —Å–ø–µ—Ü–∏—Ñ–∏–∫—É –∫–æ–Ω—Ç—Ä–∞—Ñ–∞–∫—Ç–∞</td>
</tr>
<tr>
<td align="center">üõ°Ô∏è</td>
<td><strong>–†–æ–±–∞—Å—Ç–Ω–æ—Å—Ç—å —á–µ—Ä–µ–∑ –∞–Ω—Å–∞–º–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ</strong><br>–£—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ –≤—ã–±—Ä–æ—Å–∞–º –∏ —à—É–º—É –≤ –¥–∞–Ω–Ω—ã—Ö</td>
</tr>
<tr>
<td align="center">üî¨</td>
<td><strong>–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –º–∞–ª—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π</strong><br>–ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ —Ä–µ–¥–∫–∏—Ö –±—Ä–µ–Ω–¥–æ–≤ –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π</td>
</tr>
<tr>
<td align="center">üìà</td>
<td><strong>–ê–Ω–∞–ª–∏–∑ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ç—Ä–µ–Ω–¥–æ–≤</strong><br>–£—á–µ—Ç –¥–∏–Ω–∞–º–∏–∫–∏ –ø—Ä–æ–¥–∞–∂ –∏ –≤–æ–∑–≤—Ä–∞—Ç–æ–≤</td>
</tr>
</table>

---

## üìà –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

> **–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ—Ä–æ–≥ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏:** `0.617`  
> **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–æ–¥–µ–ª–µ–π –≤ –∞–Ω—Å–∞–º–±–ª–µ:** `5`  
> **–ò–Ω–∂–µ–Ω–µ—Ä–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤:** `40+`

---

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

–ü—Ä–æ–µ–∫—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω –¥–ª—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è **OZON**.

---

## üë• –ö–æ–º–∞–Ω–¥–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

<div align="center">

*–†–µ—à–µ–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–æ –≤ —Ä–∞–º–∫–∞—Ö —Ö–∞–∫–∞—Ç–æ–Ω–∞ –ø–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—é –∫–æ–Ω—Ç—Ä–∞—Ñ–∞–∫—Ç–∞ –Ω–∞ –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–µ OZON*

**–°–¥–µ–ª–∞–Ω–æ —Å ‚ù§Ô∏è 

</div>

---

<div align="center">

### üåü –ï—Å–ª–∏ –ø—Ä–æ–µ–∫—Ç –±—ã–ª –ø–æ–ª–µ–∑–µ–Ω, –ø–æ—Å—Ç–∞–≤—å—Ç–µ –∑–≤–µ–∑–¥—É!

</div>
